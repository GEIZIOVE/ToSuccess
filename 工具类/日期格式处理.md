# 日期格式处理

## 1、后台返回前台

### 1.1 假如用的是yml文件进行配置

```yml
spring:
  jackson:
    date-format: yyyy-MM-dd HH:mm:ss
    time-zone: GMT+8
```

### 1.2 假如用的是properties文件进行配置

```properties
spring.jackson.date-format=yyyy-MM-dd HH:mm:ss
spring.jackson.time-zone=GMT+8
```



## 2、前台返回后台

### 2.1 假如Controller中传入的参数为对象实体

2.1.1如果前台传过来的格式为年月日时分秒，则直接在对应的实体类字段加上 @DateTimeFormat(pattern = “yyyy-MM-dd HH:mm:ss”)注解

```java
 @DateTimeFormat(pattern = "yyyy-MM-dd HH:mm:ss")
```

![在这里插入图片描述](E:\Development\Typora\images\fd271185d6f8432d8f0bf36146b2fe3a.png)

2.1.2 如果前台传过来的格式为年月日，则直接在对应的实体类字段加上 @DateTimeFormat(pattern = “yyyy-MM-dd”)注解

```java
  @DateTimeFormat(pattern = "yyyy-MM-dd")
```

![在这里插入图片描述](E:\Development\Typora\images\1fe2ee020807415abc5f63f3fa2bf004.png)

2.1.3 自定义实现类InitBinderDateController（无需在实体类字段上加 @DateTimeFormat注解了）

```java
import org.springframework.beans.propertyeditors.CustomDateEditor;
import org.springframework.util.StringUtils;
import org.springframework.web.bind.WebDataBinder;
import org.springframework.web.bind.annotation.ControllerAdvice;
import org.springframework.web.bind.annotation.InitBinder;

import java.beans.PropertyEditorSupport;
import java.text.SimpleDateFormat;
import java.time.LocalDateTime;
import java.time.format.DateTimeFormatter;
import java.util.Date;

@ControllerAdvice
public class InitBinderDateController {
    /**
     * 将前台传递过来的日期格式的字符串，自动转化为时间类型
     * 拦截不到@RequestBody注解修饰的参数
     */
    @InitBinder
    public void initBinder(WebDataBinder binder) {
        //java.util.Date类型格式化
        SimpleDateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
        dateFormat.setLenient(false);
        binder.registerCustomEditor(Date.class, new CustomDateEditor(dateFormat, false));

        //java.time.LocalDateTime类型格式化
        binder.registerCustomEditor(LocalDateTime.class, new PropertyEditorSupport() {
            @Override
            public void setAsText(String text) {
                if (!StringUtils.isEmpty(text)) {
                    setValue(LocalDateTime.parse(text, DateTimeFormatter.ofPattern("yyyy-MM-dd HH:mm:ss")));
                }
            }
        });
    }
}
```

![在这里插入图片描述](E:\Development\Typora\images\3c3907baf54f42448b462c2db78ba9f5.png)

### 2.2 假如Controller中传入的参数为具体的字段

![在这里插入图片描述](E:\Development\Typora\images\29110f68388d4831be56411826f5e4da.png)
解决方法参见2.1.3